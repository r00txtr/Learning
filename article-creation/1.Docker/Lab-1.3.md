# Lab 1.3: Docker Run - Part 2

In this lab, we will expand on running and managing Docker containers by working with **Nginx** and **Ubuntu** images. You’ll learn how to manipulate containerized environments, install packages, and edit files inside a running container. This lab assumes you have a basic understanding of Docker, following previous labs.

By the end of this lab, you should be able to:
- Run multiple instances of Nginx containers.
- Access and modify files inside a running container.
- Understand how to manage and inspect containers.
- Run Ubuntu containers for various tasks.

---

## Table of Contents
1. **Introduction**
2. **Running Nginx Containers (Practice 03)**
    1. Search and Run Nginx Containers
    2. Accessing and Modifying Container Files
    3. Managing and Inspecting Containers
3. **Running Ubuntu Containers (Practice 04)**
    1. Search and Pull Ubuntu Images
    2. Running and Managing Ubuntu Containers
4. **Verification**

---

## Introduction

We will run Docker commands on a node labeled `pod-[username]-node01`. The focus of this lab will be on running Nginx containers, accessing the containers, making file changes inside them, and also running Ubuntu containers to explore other Docker functionalities.

---

## Running Nginx Containers (Practice 03)

### 1. Search for Nginx Image

Before running any containers, we need to find the **Nginx** image from DockerHub.

#### 1.1 Search Nginx from DockerHub

To search for Nginx images on DockerHub:

```bash
docker search nginx
```

---

### 2. Run Nginx Containers

We will now run two Nginx containers, each with different ports.

#### 2.1 Run Nginx1 on Port 8080

```bash
docker run -d --name nginx1 -p 8080:80 nginx:latest
```

This command:
- Runs the Nginx container in detached mode (`-d`).
- Names the container `nginx1`.
- Exposes the container’s port `80` on the host's port `8080`.

#### 2.2 Run Nginx2 on Port 8081

```bash
docker run -d --name nginx2 -p 8081:80 nginx:latest
```

This container, named `nginx2`, will be accessible on the host's port `8081`.

---

### 3. Manage Nginx Containers

#### 3.1 Display Running Containers

To view all active and inactive containers:

```bash
docker ps -a
```
or
```bash
docker container ls -a
```

This will show the status of `nginx1` and `nginx2` as well as any other containers running or stopped.

#### 3.2 Check Nginx Output on Containers

To verify that the Nginx containers are running correctly, use the following `curl` commands:

```bash
curl localhost:8080
curl localhost:8081
```

- The first command checks the output of `nginx1` (default Nginx page).
- The second command checks the output of `nginx2`.

### 4. Access and Modify Files in Nginx Container

Now, let’s access `nginx2` and modify some content.

#### 4.1 Access Nginx2 Container

To enter the `nginx2` container’s interactive terminal:

```bash
docker exec -it nginx2 /bin/bash
```

#### 4.2 Update and Install Text Editor

Once inside the container, update the package list and install `nano`, a text editor:

```bash
apt-get update -y && apt-get install nano -y
```

#### 4.3 Edit the Nginx Default Page

Create or edit the `index.html` file:

```bash
nano index.html
```

Add the following text to the file:

```
hello, username.
```

#### 4.4 Move the Edited File to the Nginx Directory

Move the modified `index.html` to the Nginx default directory so it will be served by the web server:

```bash
mv index.html /usr/share/nginx/html
```

#### 4.5 Restart Nginx Service

To apply the changes, restart the Nginx service inside the container:

```bash
service nginx restart
```

### 5. Restart and Verify Nginx2

Restart the `nginx2` container to ensure everything works:

```bash
docker start nginx2
```

#### 5.1 Check Nginx Output Again

Use `curl` to check the updated content for both containers:

```bash
curl localhost:8080
curl localhost:8081
```

For `nginx1`, you should still see the default Nginx page. For `nginx2`, you should see:

```
hello, username.
```

---

### 6. Inspect and Manage Nginx Containers

#### 6.1 Display Container Descriptions

To get detailed information about the Nginx containers:

```bash
docker inspect nginx1
docker inspect nginx2
```

#### 6.2 View Logs

To view logs generated by the Nginx containers:

```bash
docker logs nginx1
docker logs nginx2
```

#### 6.3 Monitor Resource Usage

To view real-time resource usage (CPU, memory, etc.) of the containers:

```bash
docker stats nginx1
docker stats nginx2
```

#### 6.4 View Running Processes

To display running processes inside the containers:

```bash
docker top nginx1
docker top nginx2
```

---

## Running Ubuntu Containers (Practice 04)

Now, let’s work with the **Ubuntu** image to see how we can interact with basic containers for general purposes.

### 1. Search for Ubuntu Image

#### 1.1 Search Ubuntu from DockerHub

To search for Ubuntu images on DockerHub:

```bash
docker search ubuntu
```

---

### 2. Pull and Run Ubuntu Containers

#### 2.1 Pull Ubuntu Image from Harbor

First, pull the Ubuntu image from Harbor:

```bash
docker pull ubuntu
```

#### 2.2 Run Ubuntu Container (Interactive Mode)

To run an Ubuntu container and access its console interactively:

```bash
docker run -it --name ubuntu1 ubuntu
```

This command runs an interactive terminal session inside the `ubuntu1` container. You can execute commands directly within the container.

To exit the container, press `Ctrl+D` or type `exit`.

#### 2.3 Verify Container Status

After exiting the container, verify its status:

```bash
docker ps -a
```

This command lists all containers and shows that `ubuntu1` is now in an "Exited" state.

---

### 3. Run and Delete Ubuntu Container on Exit

You can run a container and automatically delete it once it’s stopped.

#### 3.1 Run and Automatically Remove Container

To run a new container (`ubuntu2`) and ensure it gets deleted after exiting:

```bash
docker run -it --rm --name ubuntu2 ubuntu
```

After running and exiting this container, check the list of containers again:

```bash
docker ps -a
```

You should see that `ubuntu2` no longer exists after it was stopped.

---

## Verification

To ensure that everything worked as expected, perform the following checks:

1. **Nginx1 container**: Use `curl` to check that you can access the default Nginx page on `localhost:8080`.
2. **Nginx2 container**: Use `curl` to check that you see `hello, username.` on `localhost:8081`.
3. **Ubuntu1 container**: Verify that the `ubuntu1` container is in the "Exited" state after running and exiting it.
4. **Ubuntu2 container**: Verify that `ubuntu2` was removed automatically after exiting.

---

Congratulations! You have successfully completed **Lab 1.3: Docker Run - Part 2**. You’ve learned how to search for images, run Nginx and Ubuntu containers, access and modify files within containers, and manage containers effectively using Docker commands.

Happy Dockering!
